<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"kusos.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":"default","style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="在此紀錄我所學到的東西">
<meta property="og:type" content="website">
<meta property="og:title" content="酷壽司的窩">
<meta property="og:url" content="https://kusos.github.io/index.html">
<meta property="og:site_name" content="酷壽司的窩">
<meta property="og:description" content="在此紀錄我所學到的東西">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Mike Chen">
<meta property="article:tag" content="關鍵字,酷壽司,kusos">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://kusos.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-TW'
  };
</script>

  <title>酷壽司的窩</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">酷壽司的窩</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">在此紀錄我所學到的東西</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>關於</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/10/13/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/13/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>
              

              <time title="創建時間：2020-10-13 08:53:14 / 修改時間：10:52:16" itemprop="dateCreated datePublished" datetime="2020-10-13T08:53:14+08:00">2020-10-13</time>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>367</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>預設文章</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/10/13/hello-world/">
                閱讀全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/09/01/2020-09-01-javascript-mongodb-crud/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/01/2020-09-01-javascript-mongodb-crud/" class="post-title-link" itemprop="url">Node.js + MongoDB 增刪修查 (CRUD)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-09-01 10:37:19" itemprop="dateCreated datePublished" datetime="2020-09-01T10:37:19+08:00">2020-09-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-10-13 11:14:11" itemprop="dateModified" datetime="2020-10-13T11:14:11+08:00">2020-10-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>2.9k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>5 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li><p>以往專案上以 Node.js 當 Server 的項目，大多搭配 MongoDB 使用，這裡紀錄一下從安裝到使用的筆記。</p>
</li>
<li><p>標題的 CRUD 是 新增（Create，意為「建立」）、查詢（Read，意為「讀取」）、修改（Update，意為「更新」）、刪除（Delete），取四個單字字首而成。</p>
</li>
</ul>
<h2 id="MongoDB-安裝與配置設定"><a href="#MongoDB-安裝與配置設定" class="headerlink" title="MongoDB 安裝與配置設定"></a>MongoDB 安裝與配置設定</h2><ul>
<li><p>安裝基本上就是一直下一步的無腦安裝，下面列了兩個載點。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://fastdl.mongodb.org/windows/mongodb-windows-x86_64-4.4.0-signed.msi">Win10版本適用載點</a>、<a target="_blank" rel="noopener" href="https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2008plus-3.4.24-signed.msi">Win8版本適用載點</a></p>
</li>
<li><p>加入環境變數 <code>;C:\Program Files\MongoDB\Server\3.4\bin</code><br><img src="https://i.imgur.com/eyAUVOL.png" alt="加入環境變數"></p>
</li>
<li><p>建立資料庫目錄 <code>d:\MongoDB\data\db</code></p>
</li>
<li><p>建立log目錄<code>d:\MongoDB\data\log</code></p>
</li>
<li><p>啟動同時，指定資料庫存放位置！ <code>mongod --dbpath d:\MongoDB\data\db</code></p>
</li>
<li><p>建立設定檔 mongod.cfg，內容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemLog:</span><br><span class="line">    destination: file</span><br><span class="line">    path: d:\MongoDB\data\log\mongod.log</span><br><span class="line">storage:</span><br><span class="line">    dbPath: d:\MongoDB\data\db</span><br></pre></td></tr></table></figure>
</li>
<li><p>安裝設定檔 mongod.cfg，日後啟動服務就不需要再次指定路徑。<br><code>mongod --config &quot;D:\MongoDB\data\mongod.cfg&quot; --install</code></p>
</li>
<li><p>啟用服務：<code>net start MongoDB</code></p>
</li>
<li><p>停用服務：<code>net stop MongoDB</code></p>
</li>
</ul>
<h2 id="MongoDB-可視化工具-GUI"><a href="#MongoDB-可視化工具-GUI" class="headerlink" title="MongoDB 可視化工具 (GUI)"></a>MongoDB 可視化工具 (GUI)</h2><p><img src="https://i.imgur.com/tEgdECM.png" alt="Robo 3T 介面"></p>
<p><a target="_blank" rel="noopener" href="https://download.studio3t.com/robomongo/windows/robo3t-1.3.1-windows-x86_64-7419c406.zip">Robo 3T 載點</a></p>
<h2 id="MongoDB-Shell-基本用法"><a href="#MongoDB-Shell-基本用法" class="headerlink" title="MongoDB Shell 基本用法"></a>MongoDB Shell 基本用法</h2><p><img src="https://i.imgur.com/dwaN9sn.png" alt="MongoDB Shell 基本用法"></p>
<h2 id="Node-js-安裝-MongoDB-driver"><a href="#Node-js-安裝-MongoDB-driver" class="headerlink" title="Node.js 安裝 MongoDB driver"></a>Node.js 安裝 MongoDB driver</h2><ul>
<li>需注意安裝本文範例語法適用的版本，保險起見就像我一樣指定版本安裝。<br><code>npm install mongodb@2.2.31 --save</code><br><img src="https://i.imgur.com/cWBAwPT.png" alt="package.json"></li>
</ul>
<h2 id="新增-Create"><a href="#新增-Create" class="headerlink" title="新增 (Create)"></a>新增 (Create)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MongoClient = <span class="built_in">require</span>(<span class="string">&#x27;mongodb&#x27;</span>).MongoClient;</span><br><span class="line"></span><br><span class="line">MongoClient.connect(<span class="string">&quot;mongodb://localhost:27017/mymondb&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, db</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  db.collection(<span class="string">&#x27;Superstar&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, collection</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">    <span class="comment">//collection.insert(新增內容)</span></span><br><span class="line">    collection.insert(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">firstName</span>: <span class="string">&#x27;Mike&#x27;</span>, <span class="attr">lastName</span>: <span class="string">&#x27;Chen&#x27;</span> &#125;);</span><br><span class="line">    collection.insert(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">firstName</span>: <span class="string">&#x27;Nicole&#x27;</span>, <span class="attr">lastName</span>: <span class="string">&#x27;Lo&#x27;</span> &#125;);</span><br><span class="line">    collection.insert(&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">firstName</span>: <span class="string">&#x27;Bill&#x27;</span>, <span class="attr">lastName</span>: <span class="string">&#x27;Gates&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    collection.count(<span class="function"><span class="keyword">function</span> (<span class="params">err, count</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;共 &#x27;</span> + count + <span class="string">&#x27; 筆資料&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  db.close(); <span class="comment">//關閉連線</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="查詢-Read"><a href="#查詢-Read" class="headerlink" title="查詢 (Read)"></a>查詢 (Read)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MongoClient = <span class="built_in">require</span>(<span class="string">&#x27;mongodb&#x27;</span>).MongoClient;</span><br><span class="line"></span><br><span class="line">MongoClient.connect(<span class="string">&quot;mongodb://localhost:27017/mymondb&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, db</span>) </span>&#123;</span><br><span class="line">  db.collection(<span class="string">&quot;Superstar&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, collection</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//collection.find(條件,callback)</span></span><br><span class="line">    collection.find(&#123; <span class="attr">firstName</span>: <span class="string">&quot;Nicole&quot;</span> &#125;).toArray(<span class="function"><span class="keyword">function</span> (<span class="params">err, items</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">      <span class="built_in">console</span>.log(items);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;查詢到 &quot;</span> + items.length + <span class="string">&quot; 個符合條件);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &#125;);</span></span><br><span class="line"><span class="string">  db.close(); //關閉連線</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>

<h2 id="修改-Update"><a href="#修改-Update" class="headerlink" title="修改 (Update)"></a>修改 (Update)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MongoClient = <span class="built_in">require</span>(<span class="string">&#x27;mongodb&#x27;</span>).MongoClient;</span><br><span class="line"></span><br><span class="line">MongoClient.connect(<span class="string">&quot;mongodb://localhost:27017/mymondb&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, db</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  db.collection(<span class="string">&#x27;Superstar&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, collection</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//collection.update(條件,更新內容,writeConcern,callback)</span></span><br><span class="line">    collection.update(&#123; <span class="attr">id</span>: <span class="number">3</span> &#125;, &#123; <span class="attr">$set</span>: &#123; <span class="attr">firstName</span>: <span class="string">&#x27;Steve&#x27;</span>, <span class="attr">lastName</span>: <span class="string">&#x27;Jobs&#x27;</span> &#125; &#125;,</span><br><span class="line">      &#123; <span class="attr">w</span>: <span class="number">1</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;更新成功！&#x27;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  db.close(); <span class="comment">//關閉連線</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="刪除-Delete"><a href="#刪除-Delete" class="headerlink" title="刪除 (Delete)"></a>刪除 (Delete)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MongoClient = <span class="built_in">require</span>(<span class="string">&#x27;mongodb&#x27;</span>).MongoClient;</span><br><span class="line"></span><br><span class="line">MongoClient.connect(<span class="string">&quot;mongodb://localhost:27017/mymondb&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, db</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  db.collection(<span class="string">&#x27;Superstar&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, collection</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//collection.remove(條件,writeConcern,callback)</span></span><br><span class="line">    collection.remove(&#123; <span class="attr">id</span>: <span class="number">2</span> &#125;, &#123; <span class="attr">w</span>: <span class="number">1</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;刪除成功！&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  db.close(); <span class="comment">//關閉連線</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/08/13/2020-08-13-csharp-taskbar-appname-different/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/13/2020-08-13-csharp-taskbar-appname-different/" class="post-title-link" itemprop="url">C# 更改專案名稱與組件名稱後，工作列上的應用程式名稱沒變</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-08-13 10:37:19" itemprop="dateCreated datePublished" datetime="2020-08-13T10:37:19+08:00">2020-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-09-01 09:56:29" itemprop="dateModified" datetime="2020-09-01T09:56:29+08:00">2020-09-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>609</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li><p>這是一個偶然發現的問題，身為工程師時常會開些小專案來試做，例如建一個叫 SampleAAA 的專案，其預設組件名稱/應用程式名稱也會叫做 SampleAAA，編譯後產生的執行檔也會叫 SampleAAA.exe。</p>
</li>
<li><p>當這個小專案測試沒問題，可能會想直接變更成正式專案，會考慮直接修改他的專案名稱、組件名稱、命名空間名稱，例如改叫 SampleBBB 好了。(其實蠻多地方需要修改的，這邊只列舉部分)</p>
</li>
<li><p>都改好後，清空 Debug 資料夾後，重新進行編譯，理所當然會產生 SampleBBB.exe，到這也沒問題。</p>
</li>
<li><p>發生問題的是，從 Debug 目錄下直接雙擊 SampleBBB.exe 後，又偶然在工作列(Taskbar)上對它的圖示點了右鍵，發現名稱還是原本的 SampleAAA，如下圖。</p>
</li>
</ul>
<p><img src="https://i.imgur.com/HOuA0zx.png" alt="名稱還是舊的"></p>
<ul>
<li>這讓我下意識的想到去搜尋看看登錄檔 ( 執行 &gt; 輸入<code>regedit</code> &gt; 搜尋 <code>SampleAAA</code>)，果然在 <code>HKEY_CLASSES_ROOT\Local Settings\Software\Microsoft\Windows\Shell\MuiCache</code> 下發現了一個有趣的東西 <code>FriendlyAppName</code> (友善的應用程式名稱？)。</li>
</ul>
<p><img src="https://i.imgur.com/35WmL1R.png" alt="FriendlyAppName"></p>
<ul>
<li>看來是微軟在初次運行執行檔的時候會記錄這個屬性，就算重新編譯，只要是路徑相同，都還是會保持原本的值。</li>
</ul>
<h2 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h2><ul>
<li><p>解決方法就是直接刪除這個機碼就可以了。</p>
</li>
<li><p>另外，其實如果把整個 Debug 資料夾搬到其他地方去執行，並不會有這問題，因為路徑不同。</p>
</li>
</ul>
<p><img src="https://i.imgur.com/wsh3aAD.png" alt="刪除就解決了"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/08/11/2020-08-11-csharp-wpf-copy-file-from-resource/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/11/2020-08-11-csharp-wpf-copy-file-from-resource/" class="post-title-link" itemprop="url">C# WPF 從 Resources 另存檔案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>
              

              <time title="創建時間：2020-08-11 10:37:19 / 修改時間：09:10:22" itemprop="dateCreated datePublished" datetime="2020-08-11T10:37:19+08:00">2020-08-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>960</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>2 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li>白板專案上有個功能，是要從 Resources 複製一初始圖片檔案另存。</li>
</ul>
<p><img src="https://i.imgur.com/SkubYQj.png" alt="Resources 中的圖片"></p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ul>
<li>利用 <code>Properties.Resources.Whiteboard</code> 找到該資源，圖片型別為 <code>System.Drawing.Bitmap</code>。</li>
<li>使用 <code>File.WriteAllBytes</code> 存檔，第一個參數是存檔路徑，第二個參數是資料來源，型別為 <code>byte[]</code>。所以需要另外寫一個函式 <code>BitmapToBytes</code> 做轉換。</li>
</ul>
<p><img src="https://i.imgur.com/jcadM4Z.png" alt="File.WriteAllBytes說明"></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//我的文件夾下以專案 Title 建立的資料夾</span></span><br><span class="line"><span class="keyword">string</span> SaveFolder = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) + <span class="string">&quot;\\&quot;</span> + <span class="keyword">this</span>.Title + <span class="string">&quot;\\&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//確保該目錄存在</span></span><br><span class="line"><span class="keyword">if</span> (Directory.Exists(SaveFolder) == <span class="literal">false</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123; Directory.CreateDirectory(SaveFolder); &#125;</span><br><span class="line">                <span class="keyword">catch</span> &#123; &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//將資源圖片另存</span></span><br><span class="line">File.WriteAllBytes(SaveFolder + <span class="string">&quot;Whiteboard.jpg&quot;</span>, BitmapToBytes(Properties.Resources.Whiteboard));</span><br><span class="line"></span><br><span class="line"><span class="comment">//型別轉換</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] <span class="title">BitmapToBytes</span>(<span class="params">System.Drawing.Bitmap Bitmap</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            MemoryStream ms = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                ms = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">                Bitmap.Save(ms, Bitmap.RawFormat);</span><br><span class="line">                <span class="keyword">byte</span>[] byteImage = <span class="keyword">new</span> Byte[ms.Length];</span><br><span class="line">                byteImage = ms.ToArray();</span><br><span class="line">                <span class="keyword">return</span> byteImage;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (ArgumentNullException ex)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> ex;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line">                ms.Close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/08/10/2020-08-10-csharp-wpf-debug-log/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/10/2020-08-10-csharp-wpf-debug-log/" class="post-title-link" itemprop="url">C# WPF 除錯(Debug) 用的 Log 該如何寫？</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-08-10 10:37:19" itemprop="dateCreated datePublished" datetime="2020-08-10T10:37:19+08:00">2020-08-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-09-01 10:06:44" itemprop="dateModified" datetime="2020-09-01T10:06:44+08:00">2020-09-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>2.3k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>4 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li>軟體開發常常會遇到一些預想不到的 Bug，Debug 的方法有很多種，例如<code>加入中斷點</code>查看參數值有無異常、用<code>try&#123;...&#125;catch(Exception e)&#123; System.Console.WriteLine(e.Message);&#125;</code>印出錯誤訊息等等。</li>
<li>但很多時候會遇到參數沒異常，甚至不會跳出任何錯誤訊息的時候，那要如何除錯呢？這時候就要根據 Log 去做分析、除錯、甚至做到能防呆，因為使用者不一定會按照我們的邏輯去操作。例如原本我們預期守規矩的使用者是先按了A才按B，但就是會有使用者直接去按B，結果導致出錯閃退，連錯誤訊息都看不到，這時基本防呆方法就是先讓B沒法按，按A後才能按B；又或者按B的時候程式先判斷是否按過A，按過A才繼續執行，沒按過就跳出提示。</li>
<li>前面的操作順序，如果使用者沒自首，要如何得知呢？就是從 Log 來看，但 Log 並不會自行產生，要如何記錄 Log 呢？</li>
</ul>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ul>
<li>記錄 Log ，說穿了就是建立一個文字檔，例如 log.txt。</li>
<li>如果檔案不存在，就使用 <code>File.CreateText</code> 建立並直接寫入；如果檔案已經存在，我們不希望內容被複寫蓋掉，而是要一直堆疊，才能看到所有的歷史記錄，就要使用<code>File.AppendText</code>。</li>
<li>如果我們還希望能夠自動記錄下時間點，就可以用 <code>DateTime.Now.ToString(&quot;yyyy-MM-dd-HH-mm-ss&quot;)</code>自訂時間格式。</li>
<li>最後我們就可以在任何您需要記錄的地方，放入 <code>Log(&quot;內容&quot;);</code> 來記錄。</li>
<li>以我為例，我常放在事件(Event)觸發的時候，常見如 Click, SelectionChanged, MouseDown, MouseMove, MouseUp, Gesture, TouchDown, TouchMove, TouchUp, ManipulationStarting, ManipulationDelta, ManipulationCompleted 等。</li>
<li>如果有使用 Socket 的話，則建議每個 Emit 和 On 都進行記錄，以確保發送和接收的邏輯都正確，不該發送的時候別發送。像我有次就是接收端應該只要接收就好，結果它接收後要做的動作剛好觸發要發送的邏輯，變成無限循環。</li>
<li>再來就是前面提到的 <code>try&#123;...&#125;catch&#123;...&#125;</code> 攔截的錯誤訊息，也可做記錄，避免程式直接閃退看不出端倪。</li>
<li>第二個參數 isPrepend 是考慮到有些人習慣將最新的 log 放在最上面可使用。</li>
</ul>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 建立操作紀錄</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;log&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isPrepend&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Log</span>(<span class="params"><span class="keyword">string</span> log, <span class="keyword">bool</span> isPrepend = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">string</span> logFilePath = AutoSaveFolder + <span class="string">&quot;log.txt&quot;</span>;</span><br><span class="line">    <span class="comment">//string logFilePath = &quot;log.txt&quot;;</span></span><br><span class="line">    <span class="keyword">string</span> time = <span class="string">&quot;[&quot;</span> + DateTime.Now.ToString(<span class="string">&quot;yyyy-MM-dd-HH-mm-ss&quot;</span>) + <span class="string">&quot;] &quot;</span>;</span><br><span class="line">    log = time + log;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//紀錄log</span></span><br><span class="line">    <span class="keyword">if</span> (!File.Exists(logFilePath))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (StreamWriter sw = File.CreateText(logFilePath))</span><br><span class="line">        &#123;</span><br><span class="line">            sw.WriteLine(log);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isPrepend)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 插入最後一行</span></span><br><span class="line">        <span class="keyword">using</span> (StreamWriter sw = File.AppendText(logFilePath))</span><br><span class="line">        &#123;</span><br><span class="line">            sw.WriteLine(log);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        List&lt;<span class="keyword">string</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="keyword">string</span>&gt;();</span><br><span class="line">        <span class="comment">// 先讀取歷史log</span></span><br><span class="line">        <span class="keyword">using</span> (StreamReader sr = File.OpenText(logFilePath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">string</span> s = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span> ((s = sr.ReadLine()) != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                list.Add(s);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 直接複寫，先寫入當前log，再寫入歷史log</span></span><br><span class="line">        <span class="keyword">using</span> (StreamWriter sw = File.CreateText(logFilePath))</span><br><span class="line">        &#123;</span><br><span class="line">            sw.WriteLine(log);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">string</span> it <span class="keyword">in</span> list.ToArray())</span><br><span class="line">            &#123;</span><br><span class="line">                sw.WriteLine(it);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="執行結果"><a href="#執行結果" class="headerlink" title="執行結果"></a>執行結果</h2><ul>
<li>第二參數不給值的話，預設 isPrepend = false 是 Append。<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Log(<span class="string">&quot;記錄內容&quot;</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><img src="https://i.imgur.com/A0ToiYf.png" alt="Append"></p>
<ul>
<li>第二參數如果給 true 是 Prepend。<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Log(<span class="string">&quot;記錄內容&quot;</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><img src="https://i.imgur.com/ODDQWWl.png" alt="Prepend"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/08/06/2020-08-06-csharp-wpf-use-unsafe-header-parsing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/06/2020-08-06-csharp-wpf-use-unsafe-header-parsing/" class="post-title-link" itemprop="url">C# WPF 抓圖遇到「伺服器認可通訊協定違規....」例外</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-08-06 10:37:19" itemprop="dateCreated datePublished" datetime="2020-08-06T10:37:19+08:00">2020-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-09-01 10:08:51" itemprop="dateModified" datetime="2020-09-01T10:08:51+08:00">2020-09-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>1.1k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>2 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li>雲端電子白板專案遇到向伺服器抓圖更新的時候，遇到 <code>「伺服器認可通訊協定違規. Section=ResponseStatusLine」</code> 的例外而報錯。</li>
</ul>
<p><img src="https://i.imgur.com/MyA6Bok.png" alt="伺服器認可通訊協定違規"></p>
<ul>
<li>請示 Google 大神後，找到解決的方式是在 Web.Config 或 App.Config 裡面加上下面這串設定值，也就是要設定 <code>useUnsafeHeaderParsing=&quot;true&quot;</code>。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.net</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">httpWebRequest</span> <span class="attr">useUnsafeHeaderParsing</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.net</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>But… WPF 似乎沒有 App.Config 這個檔案，如果是透過程式動態設定，就如下：</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Configuration;</span><br><span class="line"><span class="keyword">using</span> System.Net.Configuration;</span><br><span class="line"><span class="comment">// System.Configuration.dll 記得加入參考</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Window_Loaded</span>(<span class="params"><span class="keyword">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">//解決「伺服器認可通訊協定違規. Section=...」問題</span></span><br><span class="line">            <span class="keyword">var</span> config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);</span><br><span class="line">            <span class="keyword">var</span> settings = (SettingsSection)config.GetSection(<span class="string">&quot;system.net/settings&quot;</span>);</span><br><span class="line">            settings.HttpWebRequest.UseUnsafeHeaderParsing = <span class="literal">true</span>;</span><br><span class="line">            config.Save(ConfigurationSaveMode.Modified);</span><br><span class="line">            ConfigurationManager.RefreshSection(<span class="string">&quot;system.net/settings&quot;</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>編譯後可發現會產生 <code>appname.vshost.exe.Config</code> 這個檔案，將其複製一份，更名為 <code>appname.exe.Config</code> 即可，內容其實跟前面的 xml 是一樣的。</p>
</li>
<li><p>註： appname 就是你自己的專案名稱/應用程式名稱。</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/08/04/2020-08-04-csharp-wpf-default-input/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/04/2020-08-04-csharp-wpf-default-input/" class="post-title-link" itemprop="url">C# WPF TextBox 設定預設輸入法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>
              

              <time title="創建時間：2020-08-04 10:37:19 / 修改時間：09:08:30" itemprop="dateCreated datePublished" datetime="2020-08-04T10:37:19+08:00">2020-08-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>1.2k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>2 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li>工作上遇到登入視窗中帳號的 TextBox 預設輸入法是注音輸入法，但一般帳號是字母和數字的組合，希望可以預設改為英文輸入法。</li>
<li>以前 WinForm 是透過 <code>KeyPress 事件</code>去判定 char 是否為字母或數字 <code>Char.IsLettrOrDigit(e.KeyChar)</code>，如果不是就用 <code>e.Handled = true;</code> 讓它無作用。</li>
<li>但在 WPF 中沒有 <code>KeyPress 事件</code>，也無 <code>e.KeyChar</code> 可用，雖然有找到 <code>Char.IsLetterOrDigit((char)KeyInterop.VirtualKeyFromKey(e.Key))</code> 這樣的用法，但效果還是不好，預設仍然是注音輸入法。</li>
<li>下面方法是更改控制項初始輸入法，雖然還是可以手動切換成注音輸入法，但效果好多了。(應該沒人用中文當帳號的吧！？)</li>
</ul>
<h2 id="XAML-寫法"><a href="#XAML-寫法" class="headerlink" title="XAML 寫法"></a>XAML 寫法</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextBox</span> <span class="attr">Name</span>=<span class="string">&quot;txtName&quot;</span> <span class="attr">Width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">Height</span>=<span class="string">&quot;23&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--預設使用英文輸入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextBox.InputScope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">InputScope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">InputScope.Names</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">InputScopeName</span> <span class="attr">NameValue</span>=<span class="string">&quot;AlphanumericHalfWidth&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">InputScope.Names</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">InputScope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">TextBox.InputScope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">TextBox</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="C-寫法"><a href="#C-寫法" class="headerlink" title="C# 寫法"></a>C# 寫法</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">InputScope scope = <span class="keyword">new</span> InputScope();</span><br><span class="line">InputScopeName name = <span class="keyword">new</span> InputScopeName();</span><br><span class="line">name.NameValue = InputScopeNameValue.AlphanumericHalfWidth;</span><br><span class="line">scope.Names.Add(name);</span><br><span class="line">txtName.InputScope = scope;</span><br></pre></td></tr></table></figure>


<h2 id="WPF-限制字母或數字"><a href="#WPF-限制字母或數字" class="headerlink" title="WPF 限制字母或數字"></a>WPF 限制字母或數字</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">txtName_KeyDown</span>(<span class="params"><span class="keyword">object</span> sender, KeyEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Char.IsLetterOrDigit((<span class="keyword">char</span>)KeyInterop.VirtualKeyFromKey(e.Key)))</span><br><span class="line">    &#123;</span><br><span class="line">        e.Handled = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="WinForm-限制字母或數字"><a href="#WinForm-限制字母或數字" class="headerlink" title="WinForm 限制字母或數字"></a>WinForm 限制字母或數字</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">txtName_KeyPress</span>(<span class="params"><span class="keyword">object</span> sender, KeyPressEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Char.IsLetterOrDigit(e.KeyChar))</span><br><span class="line">    &#123;</span><br><span class="line">        e.Handled = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/07/23/2020-07-23-csharp-get-post-json-param-node/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/23/2020-07-23-csharp-get-post-json-param-node/" class="post-title-link" itemprop="url">C# GET/POST JSON/Param to Node.js</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-07-23 10:37:19" itemprop="dateCreated datePublished" datetime="2020-07-23T10:37:19+08:00">2020-07-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-07-22 13:30:55" itemprop="dateModified" datetime="2020-07-22T13:30:55+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>3.6k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>7 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li>目前專案上的架構是 WPF(C#) 應用程式要與 Node.js 伺服器溝通。</li>
<li>這邊紀錄了如何從 C# GET/POST 參數到伺服器以及伺服器端如何接收 GET/POST 過來的參數並回傳值。</li>
<li>POST 的部分分別示範了，傳 JSON 和利用組字串的方式 POST 傳送與接收方法。</li>
<li>伺服器端可依據傳送的類型，使用不同的 Parser 處理參數。</li>
<li>GET 用 <code>req.query.xxx</code> 取值；POST 用 <code>req.body.xxx</code> 取值；</li>
</ul>
<h2 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h2><ul>
<li>Newtonsoft.Json</li>
</ul>
<h2 id="WPF-端"><a href="#WPF-端" class="headerlink" title="WPF 端"></a>WPF 端</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GET - Param</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">btnGetTest_Click</span>(<span class="params"><span class="keyword">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">string</span> response = GetParam(<span class="string">&quot;http://localhost:8080/checkGet?name=mike&amp;pw=qaz&quot;</span>);</span><br><span class="line">            MessageBox.Show(response);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">GetParam</span>(<span class="params"><span class="keyword">string</span> url</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">            request.Method = <span class="string">&quot;GET&quot;</span>;</span><br><span class="line">            </span><br><span class="line">            HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line">            <span class="keyword">using</span> (StreamReader sr = <span class="keyword">new</span> StreamReader(response.GetResponseStream()))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">string</span> result = sr.ReadToEnd();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST - JSON</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">btnJsonTest_Click</span>(<span class="params"><span class="keyword">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">string</span> url = <span class="string">&quot;http://localhost:8080/checkJson&quot;</span>;</span><br><span class="line">            <span class="comment">//要傳遞的參數Sample</span></span><br><span class="line">            Object postData =</span><br><span class="line">                <span class="keyword">new</span> </span><br><span class="line">                &#123;</span><br><span class="line">                    name = <span class="string">&quot;mike&quot;</span>,</span><br><span class="line">                    pw = <span class="string">&quot;abc&quot;</span></span><br><span class="line">                &#125;;</span><br><span class="line">            <span class="keyword">string</span> response = PostJson(url, postData);</span><br><span class="line">            MessageBox.Show(response);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">PostJson</span>(<span class="params"><span class="keyword">string</span> url, Object postData</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">            request.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">            request.ContentType = <span class="string">&quot;application/json&quot;</span>;        </span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> postBody = JsonConvert.SerializeObject(postData);    </span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> (StreamWriter sw = <span class="keyword">new</span> StreamWriter(request.GetRequestStream()))</span><br><span class="line">            &#123;</span><br><span class="line">                sw.Write(postBody);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line">            <span class="keyword">using</span> (StreamReader sr = <span class="keyword">new</span> StreamReader(response.GetResponseStream()))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">string</span> result = sr.ReadToEnd();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//POST - 組字串</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">btnParamTest_Click</span>(<span class="params"><span class="keyword">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">string</span> url = <span class="string">&quot;http://localhost:8080/checkParam&quot;</span>;</span><br><span class="line">            <span class="keyword">string</span> postData <span class="string">&quot;name=nicole&amp;pw=123&quot;</span>;<span class="comment">//要傳遞的參數Sample</span></span><br><span class="line">            <span class="keyword">string</span> response = PostParam(url, postData);</span><br><span class="line">            MessageBox.Show(response);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">PostParam</span>(<span class="params"><span class="keyword">string</span> url, <span class="keyword">string</span> param</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;            </span><br><span class="line">            <span class="keyword">byte</span>[] bs = Encoding.ASCII.GetBytes(param);</span><br><span class="line"></span><br><span class="line">            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">            request.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">            request.ContentType = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br><span class="line">            request.ContentLength = bs.Length;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> (Stream rs = request.GetRequestStream())</span><br><span class="line">            &#123;</span><br><span class="line">                rs.Write(bs, <span class="number">0</span>, bs.Length);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line">            <span class="keyword">using</span> (StreamReader sr = <span class="keyword">new</span> StreamReader(response.GetResponseStream()))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">string</span> result = sr.ReadToEnd();</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>


<h2 id="Node-js-端"><a href="#Node-js-端" class="headerlink" title="Node.js 端"></a>Node.js 端</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立 application/json parser</span></span><br><span class="line"><span class="keyword">var</span> jsonParser = bodyParser.json();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立 application/x-www-form-urlencoded parser</span></span><br><span class="line"><span class="keyword">var</span> urlencodedParser = bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//GET 接受參數，使用 req.query.xxx</span></span><br><span class="line">app.get(<span class="string">&#x27;/checkGet&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(req.query.name, req.query.pw);</span><br><span class="line"></span><br><span class="line">  res.send(<span class="string">&quot;收到 GET 資料啦&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//以 JSON 傳來的用 jsonParser</span></span><br><span class="line">app.post(<span class="string">&#x27;/checkJson&#x27;</span>, jsonParser, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(req.body.name, req.body.pw);</span><br><span class="line">  res.send(<span class="string">&quot;收到 POST 來的 JSON 啦&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//以 x-www-form-urlencoded 傳來的用 urlencodedParser</span></span><br><span class="line">app.post(<span class="string">&#x27;/checkParam&#x27;</span>, urlencodedParser, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(req.body.name, req.body.pw);</span><br><span class="line">  res.send(<span class="string">&quot;收到 POST 來的 x-www-form-urlencoded 啦&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> port = <span class="number">8080</span>;</span><br><span class="line"></span><br><span class="line">server.listen(port, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Express started on http://localhost:&#x27;</span> + port + <span class="string">&#x27; \r\npress Ctrl+C to terminate.&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/07/23/2020-07-23-csharp-cmd-restart/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/23/2020-07-23-csharp-cmd-restart/" class="post-title-link" itemprop="url">C# 利用 cmd 重新啟動</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-07-23 10:37:19" itemprop="dateCreated datePublished" datetime="2020-07-23T10:37:19+08:00">2020-07-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-07-22 13:37:17" itemprop="dateModified" datetime="2020-07-22T13:37:17+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>454</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li>目前專案 WPF 程式有個重新啟動的需求，可利用 CMD 的方式達成。</li>
</ul>
<h2 id="WPF-端"><a href="#WPF-端" class="headerlink" title="WPF 端"></a>WPF 端</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">btnRestart_Click</span>(<span class="params"><span class="keyword">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            ProcessStartInfo Info = <span class="keyword">new</span> ProcessStartInfo();</span><br><span class="line">            Info.Arguments = <span class="string">&quot;/C choice /C Y /N /D Y /T 1 &amp; START \&quot;\&quot; \&quot;&quot;</span> + Application.ResourceAssembly.Location + <span class="string">&quot;\&quot;&quot;</span>;</span><br><span class="line">            Info.WindowStyle = ProcessWindowStyle.Hidden;</span><br><span class="line">            Info.CreateNoWindow = <span class="literal">true</span>;</span><br><span class="line">            Info.FileName = <span class="string">&quot;cmd.exe&quot;</span>;</span><br><span class="line">            Process.Start(Info);</span><br><span class="line">            Process.GetCurrentProcess().Kill();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kusos.github.io/2020/07/22/2020-07-22-javascript-kiosk-kaohsiung-software-park-floor-intro/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mike Chen">
      <meta itemprop="description" content="在此紀錄我所學到的東西">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="酷壽司的窩">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/22/2020-07-22-javascript-kiosk-kaohsiung-software-park-floor-intro/" class="post-title-link" itemprop="url">廣告機-高雄軟體園區樓層簡介專案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2020-07-22 10:37:19" itemprop="dateCreated datePublished" datetime="2020-07-22T10:37:19+08:00">2020-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2020-09-01 10:17:19" itemprop="dateModified" datetime="2020-09-01T10:17:19+08:00">2020-09-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Work/" itemprop="url" rel="index"><span itemprop="name">Work</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>443</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="說明"><a href="#說明" class="headerlink" title="說明"></a>說明</h2><ul>
<li>業務說高軟管委會預計購買三台廣告機，內容主要放ABC棟的樓層簡介，讓我規畫一個Sample出來提案。</li>
</ul>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><ul>
<li>他們會提供每一層 AutoCAD 平面圖，我們要將其美化。</li>
<li>每個進駐公司點進去要跳出簡介，圖片 x 2，簡介文字 200 字。</li>
<li>所有公司內容要由他們自行更新。</li>
</ul>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ul>
<li>廣告機排版軟體大致切了三個區塊，頭放 banner，身體放樓層介紹、腳放廣告影片。</li>
<li>如果不需要「跳出公司簡介」和「自行維護公司內容」的話，用排版軟體就都能搞定。</li>
<li>加了這兩個需求，身體部分變成要嵌入網頁來實作，而不能只放圖片。</li>
<li>考慮到他們的環境可能無法讓廣告機上網，所以得設計成是讀取本機的網頁檔案。</li>
<li>放在本機的資料如要讓他們自行維護，不可能讓他們自己修改程式碼或者手動替換圖片，所以只能寫一個編輯器給他們用。</li>
<li>廣告機的播放內容可透過隨身碟更新，而我網頁資料也可直接放在隨身碟內，嵌入的網址直接指定到隨身碟目錄即可。</li>
<li>直接從隨身碟執行編輯器，修改後就能直接修改對應公司的資料和替換圖片。</li>
</ul>
<h2 id="成果預覽"><a href="#成果預覽" class="headerlink" title="成果預覽"></a>成果預覽</h2><p><img src="https://i.imgur.com/gAjJCvm.png" alt="排版"><br><img src="https://i.imgur.com/9KlMYnt.png" alt="樓層簡介"><br><img src="https://i.imgur.com/4owYdmo.png" alt="公司簡介"><br><img src="https://i.imgur.com/lphzJ2O.png" alt="編輯器畫面"><br><img src="https://i.imgur.com/uI7nh6Z.png" alt="編輯畫面"><br><img src="https://i.imgur.com/jefUrB8.png" alt="廣告機實際畫面"></p>
<h2 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h2><ul>
<li>功能都實作出來了，就等美編大姊提供美美的平面圖了。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Mike Chen</p>
  <div class="site-description" itemprop="description">在此紀錄我所學到的東西</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mike Chen</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="總字數">54k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">1:39</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  

    </div>
</body>
</html>
